{{with merge (dict "component" "alerter" "command" "assemblyline_core.alerter.run_alerter" "requestedCPU" .Values.alerterReqCPU "limitCPU" .Values.alerterLimCPU) . }}
  {{template "assemblyline.coreService" .}}
{{end}}
---
{{with merge (dict "component" "workflow" "command" "assemblyline_core.workflow.run_workflow" "requestedCPU" .Values.workflowReqCPU "limitCPU" .Values.workflowLimCPU) . }}
  {{template "assemblyline.coreService" .}}
{{end}}
---
{{with merge (dict "component" "expiry" "command" "assemblyline_core.expiry.run_expiry" "requestedCPU" .Values.expiryReqCPU "limitCPU" .Values.expiryLimCPU) . }}
  {{template "assemblyline.coreService" .}}
{{end}}
{{ if .Values.enableMetrics }}
---
{{with merge (dict "component" "metrics" "command" "assemblyline_core.metrics.run_metrics_aggregator" "requestedCPU" .Values.metricsReqCPU "limitCPU" .Values.metricsLimCPU) . }}
  {{template "assemblyline.coreServiceNoCheck" .}}
{{end}}
{{end}}
---
{{with merge (dict "component" "statistics" "command" "assemblyline_core.metrics.run_statistics_aggregator" "requestedCPU" .Values.statisticsReqCPU "limitCPU" .Values.esMetricsLimCPU) . }}
  {{template "assemblyline.coreServiceNoCheck" .}}
{{end}}
{{ if .Values.enableMetrics }}
---
{{with merge (dict "component" "es-metrics" "command" "assemblyline_core.metrics.es_metrics" "requestedCPU" .Values.esMetricsReqCPU "limitCPU" .Values.esMetricsLimCPU) . }}
  {{template "assemblyline.coreService" .}}
{{end}}
{{end}}
---
{{with merge (dict "component" "heartbeat" "command" "assemblyline_core.metrics.run_heartbeat_manager" "requestedCPU" .Values.heartbeatReqCPU "limitCPU" .Values.heartbeatLimCPU) . }}
  {{template "assemblyline.coreService" .}}
{{end}}
---
{{with merge (dict "component" "plumber" "command" "assemblyline_core.plumber.run_plumber" "requestedCPU" .Values.plumberReqCPU "limitCPU" .Values.plumberLimCPU) . }}
  {{template "assemblyline.coreService" .}}
{{end}}
---
{{with merge (dict "component" "dispatcher" "command" "assemblyline_core.dispatching" "replicas" .Values.dispatcherInstances "requestedCPU" .Values.dispatcherReqCPU "limitCPU" .Values.dispatcherLimCPU) . }}
  {{template "assemblyline.coreService" .}}
{{end}}
---
{{with merge (dict "component" "ingester" "command" "assemblyline_core.ingester" "replicas" .Values.ingesterInstances  "requestedCPU" .Values.ingesterReqCPU "limitCPU" .Values.ingesterLimCPU) . }}
  {{template "assemblyline.coreService" .}}
{{end}}
